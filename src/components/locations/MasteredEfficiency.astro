---
import Logo from "../../assets/logos/TOUTOLERON_Embleme_blanc.svg";
import CheckIcon from "../../assets/svg/check.svg";
import Arrow2 from "../../assets/svg/arrow-02.svg";

class CardItem {
    constructor(public hint: string, public title: string, public bullets: string[] = [], public emoji: string = "") {
        this.hint = hint;
        this.title = title;
        this.bullets = bullets;
        this.emoji = emoji;
    }
}

const cardItems: CardItem[] = [
    new CardItem(
        "Z√©ro charge mentale IT",
        "S√©r√©nit√© au quotidien",
        [
            "Garantie compl√®te du mat√©riel pendant toute la dur√©e de la location.",
            "Pr√™t express en 48h en cas de panne.",
            "Acc√®s direct et illimit√© au service client.",
        ],
        "üßò"
    ),
    new CardItem(
        "Simplement tout compris",
        "Efficience budg√©taire",
        [
            "Mat√©riel de r√©f√©rence √† tarif pr√©f√©rentiel.",
            "Abonnement sur-mesure, sans apport ni d√©p√¥t de garantie.",
            "Frais de livraison, installation et renouvellement inclus.",
        ],
        "üí°"
    ),
    new CardItem(
        "Continuit√© du soin",
        "Outil op√©rationnel",
        [
            "Package adapt√© aux besoins r√©els.",
            "Suivi √† distance.",
            "R√©installation WEDA incluse.",
        ],
        "ü©∫"
    ),
];
---

<section id="mastered-efficiency"
         class="relative grid justify-items-center lg:justify-items-start items-center bg-primary h-200 overflow-hidden">

    <img src={Logo.src} alt="Logo" class="h-225 w-auto opacity-15 lg:-translate-x-60"/>

    <div data-anim-group class="absolute flex flex-col justify-self-center items-center p-6 xl:p-8">
        <h2 data-anim="reveal" class="text-3xl md:text-4xl xl:text-5xl text-center mb-10">
            Marre des journ√©es √† g√©rer les pannes ? <br/>
            <span class="font-semibold">Place √† l‚Äôefficacit√© ma√Ætris√©e.</span>
        </h2>

        <!-- Cards -->
        <div class="hidden xl:flex gap-8 px-8">
            {cardItems.map((c) => (
                    <div data-anim="reveal" class="card bg-base-300 shadow-sm max-w-xs">
                        <div class="card-body">
                            <div class="flex items-center gap-3">
                                <div class="h-10 w-10 rounded-full bg-white flex items-center justify-center text-xl">
                                    {c.emoji}
                                </div>
                            </div>
                            <div class="mt-2 text-base-content/70 text-sm">{c.hint}</div>
                            <div>
                                <p class="mt-1 text-xl font-semibold">{c.title}</p>

                                <ul class="mt-3 space-y-3">
                                    {c.bullets.map((b) => (
                                            <li class="flex items-start gap-3">
                                                <img src={CheckIcon.src} alt="" class="h-5 w-5 mt-0.5"/>
                                                <span>{b}</span>
                                            </li>
                                    ))}
                                </ul>
                            </div>
                        </div>
                    </div>
            ))}
        </div>

        <div id="efficacite-maitrisee-carousel" class="carousel gap-12 max-w-80 overflow-hidden xl:hidden">
            {cardItems.map((cardItem, index) => (
                    <div data-anim="reveal" id={`efficacite-maitrisee-${index}`}
                         class="carousel-item flex flex-col items-center justify-center max-w-80 h-full">
                        <div class="flex items-center justify-center gap-4">
                            {index > 0 &&
                                    <a href={`#efficacite-maitrisee-${index - 1}`}>
                                        <img class="h-16 w-16" src={Arrow2.src} alt="Pr√©c√©dent"/>
                                    </a>}
                            {index < cardItems.length - 1 &&
                                    <a href={`#efficacite-maitrisee-${index + 1}`}>
                                        <img class="h-16 w-16 rotate-y-180" src={Arrow2.src} alt="Suivant"/>
                                    </a>}
                        </div>
                        <div class="card bg-base-300 shadow-sm">
                            <div class="card-body">
                                <div class="flex items-center gap-3">
                                    <div class="h-10 w-10 rounded-full bg-base-200 flex items-center justify-center text-xl">
                                        {cardItem.emoji}
                                    </div>
                                </div>
                                <div class="mt-2 text-base-content/70 text-sm">{cardItem.hint}</div>
                                <h3 class="mt-1 text-xl font-semibold">{cardItem.title}</h3>

                                <ul class="mt-3 space-y-3">
                                    {cardItem.bullets.map((b) => (
                                            <li class="flex items-start gap-3">
                                                <img src={CheckIcon.src} alt="" class="h-5 w-5 mt-0.5"/>
                                                <span>{b}</span>
                                            </li>
                                    ))}
                                </ul>
                            </div>
                        </div>
                    </div>
            ))}
        </div>

        <!-- CTA -->
        <div data-anim="reveal" class="mt-8 flex justify-center">
            <a target="_blank"
               href='https://outlook.office.com/book/CommercialToutolron@toutoleron.com/?ismsaljsauthenabled'
               class="btn btn-accent hover:bg-accent/80 rounded-full text-xl p-6 text-accent-content shadow-none border-0">
                Je prends rendez-vous
            </a>
        </div>
    </div>
</section>

<script>
    if (typeof window !== "undefined") {
        const carousel = document.getElementById("efficacite-maitrisee-carousel");
        if (carousel) {
            const links = carousel.querySelectorAll('a[href^="#efficacite-maitrisee-"]');

            links.forEach((link) => {
                link.addEventListener("click", (event) => {
                    event.preventDefault();

                    const href = link.getAttribute("href");
                    if (!href) return;

                    const targetId = href.substring(1);
                    const target = document.getElementById(targetId);
                    if (!target || !(target instanceof HTMLElement)) return;

                    // Position horizontale de la slide par rapport au conteneur du carousel
                    const targetLeft = target.offsetLeft - carousel.offsetLeft;

                    carousel.scrollTo({
                        left: targetLeft,
                        behavior: "smooth",
                    });
                });
            });
        }
    }
</script>