---
import Illustration from "../../assets/illustrations/TOUTOLERON_illu_boite_a_outil.png";
import ShapeFileSVG from "../../assets/svg/shape-file-01.svg";
import Hero from "../../assets/photos/visuals/Visuel-10.jpg";
import LogoTerra from "../../assets/svg/terra.svg";
import LogoAsus from "../../assets/svg/asus.svg";
import LogoHP from "../../assets/svg/hp.svg";
import LogoLogitech from "../../assets/svg/logitech.svg";
import LogoFujitsu from "../../assets/svg/fujitsu.svg";

interface Props {
    hero?: ImageMetadata;
    partners?: string[];
    titleLine1?: string;
    titleLine2?: string;
    paragraph?: string;
    highlight?: string;
}

const {
    partners = [LogoTerra.src, LogoAsus.src, LogoHP.src, LogoFujitsu.src, LogoLogitech.src],
    titleLine1 = "Votre outil informatique doit vous",
    titleLine2 = "faire gagner du temps et être fiable.",
    paragraph = "Pannes et ralentissements fréquents, matériel obsolète, mise à jour au mauvais moment, maintenance logicielle, antivirus à configurer… L’informatique peut rapidement devenir une perte de temps et une source de stress.",
    highlight = "Avec l’offre Toutoléron, le matériel informatique est adapté, fiable et remplacé avant même de poser problème pour que chaque minute reste consacrée aux patients.",
} = Astro.props as Props;
---

<section id="branding-locations">
    <div data-anim-group class="px-4 md:px-16">
        <!-- Partners row -->
        <div class="flex items-center justify-start gap-2 sm:gap-4 md:gap-8 text-base-content/70 px-2">
            {partners.map((p) => (
                    <img data-anim="reveal" src={p} alt="Partenaire" class="w-10 sm:w-18 lg:w-22 h-auto"/>
            ))}
        </div>

        <!-- Hero image -->
        <div data-anim="reveal" class="w-full aspect-[531.78/245.43] md:transform md:-translate-y-12">
            <img
                    src={Hero.src}
                    alt="Matériel informatique en cabinet"
                    class="
      rotate-y-180 block w-full h-full object-cover
      [mask-image:url('/src/assets/svg/shape-file-photo.svg')]
      [-webkit-mask-image:url('/src/assets/svg/shape-file-photo.svg')]
      [mask-repeat:no-repeat]
      [mask-position:center]
      [mask-size:contain]
    "
            />
        </div>
    </div>

    <div class="h-16"/>

    <!-- Text + Illustration block -->
    <div class="px-8 md:px-16 grid md:grid-cols-3 gap-8 items-center">
        <div data-anim-group class="md:col-span-2 space-y-12">
            <h2 data-anim="reveal" class="text-xl sm:text-2xl md:text-4xl leading-tight">
                {titleLine1} <br/>
                <span class="font-semibold">{titleLine2}</span>
            </h2>

            <p data-anim="reveal" class="mt-6 max-w-2xl text-lg">{paragraph}</p>

            <p data-anim="reveal" class="mt-6 font-semibold text-lg max-w-2xl">{highlight}</p>
        </div>

        <div id="branding-illustration-collage" class="hidden md:block relative">
            <img src={ShapeFileSVG.src} alt="" class="w-full h-auto" />
            <div class="absolute inset-0 flex flex-col justify-center">
                <img
                    src={Illustration.src}
                    alt="Illustration maintenance"
                    class="w-full h-auto branding-illustration"
                />
            </div>
        </div>
    </div>
  <script>
    if (typeof window !== "undefined") {
      const collage = document.getElementById("branding-illustration-collage");

      if (collage) {
        const img = collage.querySelector(".branding-illustration");

        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                // La section entre dans le viewport → joue l'anim
                img?.classList.add("is-visible");
              } else {
                // La section sort du viewport → reset à l'état initial
                img?.classList.remove("is-visible");
              }
            });
          },
          { threshold: 0.3 }
        );

        observer.observe(collage);
      }
    }
  </script>
  <style>
    /* État initial : légèrement décalée vers la DROITE, un peu réduite, transparente */
    .branding-illustration {
      transform: translateX(3rem) translateY(0.75rem) scale(0.9);
      opacity: 0;

      transition:
        transform 1500ms cubic-bezier(0.22, 1, 0.36, 1),
        opacity 1500ms ease-out;
    }

    /* État final : position normale dans le ShapeFile */
    #branding-illustration-collage .branding-illustration.is-visible {
      transform: translateX(0) translateY(0) scale(1);
      opacity: 1;
    }
  </style>
</section>
